/** * @module 质检管理 * @fuc 成品不良通知单 * @version 1.1 * @author zhuxw */$(function(){	//维护和审核调用的是同一页面，只是按钮不同，所以需要设置	//审核页面需要隐藏的按钮	shBtnHidden(["edit","delete"]);		$("#delete").click(function(){			var selRowId = parent.document.getElementById("selRowId").value;		if (selRowId == null || "" == selRowId) {			parent.showErrorMsg("\u4e3b\u8868\u6ca1\u6709\u8bb0\u5f55");			return;		}		var state = parent.topcontent.document.getElementById("state" + selRowId).value;		if (state != "未提交" && state != "\u9000\u56de" && state != "\u5426\u51b3" && state != "\u64a4\u9500") {			parent.showErrorMsg("\u6570\u636e\u5904\u4e8e\u65e0\u6cd5\u7f16\u8f91\u72b6\u6001");			return;		}		//查找当前是否有选中的记录		var checkBox = $("#ordertb tr:gt(0) input:checked");		if(checkBox.length<1){			parent.showErrorMsg("请至少选择一条记录");			return;		}		parent.showConfirm("您确认要删除吗","bottomcontent.multiRecDeletes();");	});	$("#edit").click(function(){        var checkBox = $("#ordertb tr:gt(0) input:checked");		var ids = "";		if(checkBox.length>0){			//获取所有选中的记录			checkBox.each(function(){				ids = ids+"'"+$(this).val()+"',";			});			ids = ids.substr(0,ids.length-1);		}		$("#CPBLTZDMXIDS").val(ids);		$("#form1").attr("action","newmasterslave.shtml?action=toChildEdit");		$("#form1").submit();	});		$("#allChecked").click(function(){		var flag = document.getElementById("allChecked").checked;		if(flag){			$("#ordertb :checkbox").attr("checked","true");		}else{			$("#ordertb :checkbox").removeAttr("checked");		}	});});function multiRecDeletes(){//查找当前是否有选中的记录	var checkBox = $("#ordertb tr:gt(0) input:checked");	//获取所有选中的记录	var ids = "";	checkBox.each(function(){		ids = ids+"'"+$(this).val()+"',";	});	ids = ids.substr(0,ids.length-1);		$.ajax({		url: "newmasterslave.shtml?action=childDelete",		type:"POST",		dataType:"text",		data:{"CPBLTZDMXIDS":ids},		complete: function(xhr){			eval("jsonResult = "+xhr.responseText);			if(jsonResult.success===true){				parent.showMsgPanel("删除成功");				checkBox.parent().parent().remove();			}else{				parent.showErrorMsg(utf8Decode(jsonResult.messages));			}		}	});}
