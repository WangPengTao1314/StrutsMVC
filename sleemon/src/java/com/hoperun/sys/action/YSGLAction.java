/** * 项目名称：平台 * 系统名： * 文件名：Notice.java */package com.hoperun.sys.action;import java.io.PrintWriter;import java.util.HashMap;import java.util.List;import java.util.Map;import javax.servlet.http.HttpServletRequest;import javax.servlet.http.HttpServletResponse;import org.apache.struts.action.ActionForm;import org.apache.struts.action.ActionForward;import org.apache.struts.action.ActionMapping;import com.hoperun.commons.action.BaseAction;import com.hoperun.commons.model.Consts;import com.hoperun.commons.model.IListPage;import com.hoperun.commons.util.ParamUtil;import com.hoperun.commons.util.StringUtil;import com.hoperun.sys.model.YsglModel;import com.hoperun.sys.service.YsglService;// TODO: Auto-generated Javadoc/** * * @module * * @func * * @version 1.1 * * @author 葛俊卿 * * @createdate 2012-2-14 */public class YSGLAction extends BaseAction {	/** 业务逻辑对象. */	private YsglService ysglService;	/**	 * Sets the ysgl service.	 * 	 * @param ysglService the new ysgl service	 */	public void setYsglService(YsglService ysglService) {		this.ysglService = ysglService;	}	/**	 * * 信息框架页面	 * *	 * * @param mapping	 * * @param form	 * * @param request	 * * @param response	 * * @return.	 * 	 * @param mapping the mapping	 * @param form the form	 * @param request the request	 * @param response the response	 * 	 * @return the action forward	 */	public ActionForward toFrame(ActionMapping mapping, ActionForm form,			HttpServletRequest request, HttpServletResponse response) {		// 设置跳转时需要的一些公用属性		ParamUtil.setCommAttributeEx(request);		return mapping.findForward("frames");	}	/**	 * * 查询结果列表	 * *	 * * @param mapping	 * * @param form	 * * @param request	 * * @param response	 * * @return.	 * 	 * @param mapping the mapping	 * @param form the form	 * @param request the request	 * @param response the response	 * 	 * @return the action forward	 */	public ActionForward toList(ActionMapping mapping, ActionForm form,			HttpServletRequest request, HttpServletResponse response) {		Map<String, String> params = new HashMap<String, String>();		ParamUtil.putStr2Map(request, "XTYHID", params);		String XTYHID = ParamUtil.get(request, "XTYHID");		String csskey = ysglService.getString(XTYHID);		List<YsglModel> result = ysglService.query(params);		if(null!=csskey){			for (YsglModel ysglModel : result) {				if(csskey.equalsIgnoreCase(ysglModel.getCSSKEY())){					ysglModel.setMRBJ("1");				}else{					ysglModel.setMRBJ("0");				}			}		}		request.setAttribute("rst", result);		return mapping.findForward("list");	}		/**	 * * 保存操作	 * *	 * * @param mapping	 * * @param form	 * * @param request	 * * @param response	 * * @return.	 * 	 * @param mapping the mapping	 * @param form the form	 * @param request the request	 * @param response the response	 */	public void edit(ActionMapping mapping, ActionForm form,			HttpServletRequest request, HttpServletResponse response) {		PrintWriter writer = getWriter(response);		String jsonResult = jsonResult();		String XTYHID = ParamUtil.get(request, "XTYHID");		String SYSCSSID = ParamUtil.get(request, "SYSCSSID");		try{			int num = ysglService.queryOne(XTYHID);			if (0 == num) {				String XTYHCSSID =StringUtil.uuid32len();				ysglService.insert(XTYHCSSID,XTYHID,SYSCSSID);			}else{				ysglService.updateOne(XTYHID,SYSCSSID);			}		}catch (Exception e) {			jsonResult = jsonResult(false, "操作失败");		}		if (null != writer) {			writer.write(jsonResult);			writer.close();		}	}}